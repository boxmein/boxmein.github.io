<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Tartu CTF 2018 - Writeup - boxmein</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="I participated in a cybersecurity contest called a CTF (for capture the flag). It&rsquo;s a format of a security game where contestants have to attack a web or other type of server, and to prove their progress in breaking the server, they submit text strings called &ldquo;flags&rdquo; found at various steps of progress.
In the Tartu CTF 2018, we were playing the Game of Thrones CTF. At the start of the contest, we were given an IP address and nothing else."><meta property="og:image" content><meta property="og:title" content="Tartu CTF 2018 - Writeup"><meta property="og:description" content="I participated in a cybersecurity contest called a CTF (for capture the flag). It&rsquo;s a format of a security game where contestants have to attack a web or other type of server, and to prove their progress in breaking the server, they submit text strings called &ldquo;flags&rdquo; found at various steps of progress.
In the Tartu CTF 2018, we were playing the Game of Thrones CTF. At the start of the contest, we were given an IP address and nothing else."><meta property="og:type" content="article"><meta property="og:url" content="https://boxmein.github.io/posts/2018-11-03-tartu-ctf-2018-writeup/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2018-11-03T00:00:00+00:00"><meta property="article:modified_time" content="2018-11-03T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Tartu CTF 2018 - Writeup"><meta name=twitter:description content="I participated in a cybersecurity contest called a CTF (for capture the flag). It&rsquo;s a format of a security game where contestants have to attack a web or other type of server, and to prove their progress in breaking the server, they submit text strings called &ldquo;flags&rdquo; found at various steps of progress.
In the Tartu CTF 2018, we were playing the Game of Thrones CTF. At the start of the contest, we were given an IP address and nothing else."><link href=https://boxmein.github.io/css/fonts.2c2227b81b1970a03e760aa2e6121cd01f87c88586803cbb282aa224720a765f.css rel=stylesheet><link rel=stylesheet type=text/css media=screen href=https://boxmein.github.io/css/main.ac08a4c9714baa859217f92f051deb58df2938ec352b506df655005dcaf98cc0.css><script src=https://boxmein.github.io/posthog-tag.js></script></head><body><div class=content><header><div class=main><a href=https://boxmein.github.io/>boxmein</a></div><nav></nav></header><main><article><div class=title><h1 class=title>Tartu CTF 2018 - Writeup</h1><div class=meta>Posted on Nov 3, 2018</div></div><section class=body><p><em>I participated in a cybersecurity contest called a CTF (for capture the flag). It&rsquo;s a format of a security game where contestants have to attack a web or other type of server, and to prove their progress in breaking the server, they submit text strings called &ldquo;flags&rdquo; found at various steps of progress.</em></p><p>In the Tartu CTF 2018, we were playing the <strong><a href=https://github.com/OscarAkaElvis/game-of-thrones-hacking-ctf>Game of Thrones CTF</a></strong>. At the start of the contest, we were given an IP address and nothing else. Time to get started.</p><p>The first thing we did was do a port scan to figure out the services the CTF server was hosting.</p><p>Here&rsquo;s the results:</p><p>johannesk@nyx TartuCTF % nmap -sV 192.168.1.205 -p 21,22,80,53
Starting Nmap 7.12 ( <a href=https://nmap.org>https://nmap.org</a> ) at 2018-11-03 12:35 EET
Nmap scan report for 7kingdoms.lan (192.168.1.205)
Host is up (0.0047s latency).
PORT STATE SERVICE VERSION
21/tcp open ftp Pure-FTPd
22/tcp open ssh Linksys WRT45G modified dropbear sshd (protocol 2.0)
53/tcp open domain ISC BIND Bind
80/tcp open http Apache httpd
Service Info: Device: router</p><p>We could see from here that we&rsquo;ve got a web server. Visiting it showed me a nice page with a Game of Thrones themed image on it.</p><p>Viewing the source code, however, reveals an HTML comment with more detailed info.</p><ul><li>There&rsquo;s 11 flags</li><li>7 of the flags have to be solved in order</li><li>One of the flags is the &ldquo;final battle flag&rdquo;</li><li>The remaining 3 are unrelated to the order they&rsquo;re solved in</li><li>There&rsquo;s a battle map to be obtained to help me navigate this challenge machine</li></ul><p>Next up, we checked robots.txt. That&rsquo;s a common place where CTF creators hide paths. We discovered three paths:</p><ul><li>/secret-island/. That&rsquo;s our battle map.</li><li>/the-tree/. Some sort of hint to be checked out later.</li><li>/direct-access-to-kings-landing/. Some sort of hint to be checked out later.</li></ul><h1 id=challenge-1-dorne-ftp>Challenge 1: Dorne (FTP)</h1><p>Checking out the battle map, and picking up a hint from the index page, reveals to us that &ldquo;Dorne&rdquo; is the name of the FTP challenge.</p><p>To solve Dorne, the other paths might be of use. Turns out /the-tree/ hides a hint in a sentence about using a different User-Agent to access the page, and something about a three eyed raven.</p><p>curl -H &ldquo;User-Agent: Three-eyed-raven&rdquo; http://192.168.1.205/the-tree/</p><p>This user agent reveals to us a different page with a comment in the source code, revealing to me the Dorne username: &ldquo;oberynmartell&rdquo;.</p><p>To find the password, after a lot of struggles, we discovered the path /h/i/d/d/e/n/ that gave us the Dorne password.</p><p>We grabbed the Dorne flag from the FTP server&rsquo;s text banner and pulled the two files the FTP server was serving.</p><h1 id=challenge-2-winterfell-http>Challenge 2: Winterfell (HTTP)</h1><p>The first file was a file referencing &ldquo;mcrypt&rdquo; and the second was a plain text file called problems_in_the_north.txt describing a hashing algorithm and containing a hash. Probably, the file&rsquo;s encryption key was revealed by reversing the hash.</p><p>We reversed the hash using john and decrypted the file.</p><p>root@kali:~# cat hashes.txt
nobody:6000e084bf18c302eae4559d48cb520c$2hY68a
root@kali:~# john &ndash;format=dynamic_2008 hashes.txt
Using default input encoding: UTF-8
Loaded 1 password hash (dynamic_2008 [md5(md5($s).$p) (PW > 23 bytes) 128/128 AVX 4x3])
Press &lsquo;q&rsquo; or Ctrl-C to abort, almost any other key for status
stark (nobody)
1g 0:00:00:00 DONE 3/3 (2018-11-03 13:54) 3.448g/s 571989p/s 571989c/s 571989C/s 142400..murum
Use the &ldquo;&ndash;show&rdquo; option to display all of the cracked passwords reliably
Session completed</p><p>Using the username nobody and the password stark on the encrypted file reveals the file contents to us.</p><p>The file contents revealed to us a domain name to visit (not a real one) - so we tried to visit the web server&rsquo;s IP using the same path. We were greeted by a web page that told us to sod off, since Apache was not matching the right Vhost.</p><p>We added an /etc/hosts entry to the site, and tried again. That worked. After logging in with HTTP basic auth, we got the HTTP challenge&rsquo;s flag.</p><p>And it worked! We got the flag and a cute page with a Stark emblem image.</p></section><div class=post-tags></div></article></main><footer><div style=display:flex></div><div class=footer-info>2022 <a href=https://github.com/athul/archie>Archie Theme</a> | Built with <a href=https://gohugo.io>Hugo</a></div></footer></div></body></html>